[2024-10-04T08:13:57.388+0000] {taskinstance.py:1083} INFO - Dependencies all met for <TaskInstance: airflow-mnist.train manual__2024-10-04T08:13:50.275643+00:00 [queued]>
[2024-10-04T08:13:57.393+0000] {taskinstance.py:1083} INFO - Dependencies all met for <TaskInstance: airflow-mnist.train manual__2024-10-04T08:13:50.275643+00:00 [queued]>
[2024-10-04T08:13:57.393+0000] {taskinstance.py:1279} INFO - 
--------------------------------------------------------------------------------
[2024-10-04T08:13:57.393+0000] {taskinstance.py:1280} INFO - Starting attempt 1 of 2
[2024-10-04T08:13:57.393+0000] {taskinstance.py:1281} INFO - 
--------------------------------------------------------------------------------
[2024-10-04T08:13:57.402+0000] {taskinstance.py:1300} INFO - Executing <Task(BashOperator): train> on 2024-10-04 08:13:50.275643+00:00
[2024-10-04T08:13:57.409+0000] {standard_task_runner.py:55} INFO - Started process 560 to run task
[2024-10-04T08:13:57.411+0000] {standard_task_runner.py:82} INFO - Running: ['***', 'tasks', 'run', '***-mnist', 'train', 'manual__2024-10-04T08:13:50.275643+00:00', '--job-id', '4', '--raw', '--subdir', 'DAGS_FOLDER/src/main.py', '--cfg-path', '/tmp/tmpax4fk4de']
[2024-10-04T08:13:57.411+0000] {standard_task_runner.py:83} INFO - Job 4: Subtask train
[2024-10-04T08:13:57.454+0000] {task_command.py:388} INFO - Running <TaskInstance: airflow-mnist.train manual__2024-10-04T08:13:50.275643+00:00 [running]> on host be56adf0b2de
[2024-10-04T08:13:57.502+0000] {taskinstance.py:1509} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=***-mnist
AIRFLOW_CTX_TASK_ID=train
AIRFLOW_CTX_EXECUTION_DATE=2024-10-04T08:13:50.275643+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=manual__2024-10-04T08:13:50.275643+00:00
[2024-10-04T08:13:57.503+0000] {subprocess.py:63} INFO - Tmp dir root location: 
 /tmp
[2024-10-04T08:13:57.503+0000] {subprocess.py:75} INFO - Running command: ['/bin/bash', '-c', 'python /opt/***/dags/src/train.py --data_path /home/***/gcs/data/mnist/train/mnist.npz --model_path /home/***/gcs/data/models/mnist_linear_saved_model']
[2024-10-04T08:13:57.517+0000] {subprocess.py:86} INFO - Output:
[2024-10-04T08:13:57.634+0000] {subprocess.py:93} INFO - 2024-10-04 08:13:57.634822: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
[2024-10-04T08:13:57.635+0000] {subprocess.py:93} INFO - To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
[2024-10-04T08:13:57.739+0000] {subprocess.py:93} INFO - 2024-10-04 08:13:57.739219: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/lib
[2024-10-04T08:13:57.739+0000] {subprocess.py:93} INFO - 2024-10-04 08:13:57.739244: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
[2024-10-04T08:13:57.757+0000] {subprocess.py:93} INFO - 2024-10-04 08:13:57.757483: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
[2024-10-04T08:13:58.512+0000] {subprocess.py:93} INFO - 2024-10-04 08:13:58.512133: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/lib
[2024-10-04T08:13:58.512+0000] {subprocess.py:93} INFO - 2024-10-04 08:13:58.512198: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/lib
[2024-10-04T08:13:58.512+0000] {subprocess.py:93} INFO - 2024-10-04 08:13:58.512208: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
[2024-10-04T08:13:59.900+0000] {subprocess.py:93} INFO - 2024-10-04 08:13:59.900670: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/lib
[2024-10-04T08:13:59.900+0000] {subprocess.py:93} INFO - 2024-10-04 08:13:59.900864: W tensorflow/stream_executor/cuda/cuda_driver.cc:263] failed call to cuInit: UNKNOWN ERROR (303)
[2024-10-04T08:13:59.901+0000] {subprocess.py:93} INFO - 2024-10-04 08:13:59.900898: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:163] no NVIDIA GPU device is present: /dev/nvidia0 does not exist
[2024-10-04T08:13:59.901+0000] {subprocess.py:93} INFO - 2024-10-04 08:13:59.901081: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
[2024-10-04T08:13:59.901+0000] {subprocess.py:93} INFO - To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
[2024-10-04T08:14:00.204+0000] {subprocess.py:93} INFO - 2024-10-04 08:14:00.204643: W tensorflow/core/framework/cpu_allocator_impl.cc:82] Allocation of 188160000 exceeds 10% of free system memory.
[2024-10-04T08:14:01.911+0000] {subprocess.py:93} INFO -    1/1875 [..............................] - ETA: 6:56 - loss: 2.2379 - accuracy: 0.0312  71/1875 [>.............................] - ETA: 1s - loss: 1.0268 - accuracy: 0.7289   145/1875 [=>............................] - ETA: 1s - loss: 0.7439 - accuracy: 0.7994 218/1875 [==>...........................] - ETA: 1s - loss: 0.6287 - accuracy: 0.8270 290/1875 [===>..........................] - ETA: 1s - loss: 0.5462 - accuracy: 0.8505 363/1875 [====>.........................] - ETA: 1s - loss: 0.4938 - accuracy: 0.8641 436/1875 [=====>........................] - ETA: 0s - loss: 0.4564 - accuracy: 0.8742 509/1875 [=======>......................] - ETA: 0s - loss: 0.4293 - accuracy: 0.8818 581/1875 [========>.....................] - ETA: 0s - loss: 0.4111 - accuracy: 0.8864 653/1875 [=========>....................] - ETA: 0s - loss: 0.3928 - accuracy: 0.8910 723/1875 [==========>...................] - ETA: 0s - loss: 0.3751 - accuracy: 0.8951 796/1875 [===========>..................] - ETA: 0s - loss: 0.3624 - accuracy: 0.8988 869/1875 [============>.................] - ETA: 0s - loss: 0.3516 - accuracy: 0.9020 943/1875 [==============>...............] - ETA: 0s - loss: 0.3395 - accuracy: 0.90491017/1875 [===============>..............] - ETA: 0s - loss: 0.3298 - accuracy: 0.90781087/1875 [================>.............] - ETA: 0s - loss: 0.3209 - accuracy: 0.90991159/1875 [=================>............] - ETA: 0s - loss: 0.3122 - accuracy: 0.91201230/1875 [==================>...........] - ETA: 0s - loss: 0.3056 - accuracy: 0.91371303/1875 [===================>..........] - ETA: 0s - loss: 0.2992 - accuracy: 0.91531374/1875 [====================>.........] - ETA: 0s - loss: 0.2916 - accuracy: 0.91731448/1875 [======================>.......] - ETA: 0s - loss: 0.2853 - accuracy: 0.91891521/1875 [=======================>......] - ETA: 0s - loss: 0.2792 - accuracy: 0.92051592/1875 [========================>.....] - ETA: 0s - loss: 0.2751 - accuracy: 0.92171665/1875 [=========================>....] - ETA: 0s - loss: 0.2698 - accuracy: 0.92301738/1875 [==========================>...] - ETA: 0s - loss: 0.2653 - accuracy: 0.92441811/1875 [===========================>..] - ETA: 0s - loss: 0.2608 - accuracy: 0.92561875/1875 [==============================] - 2s 695us/step - loss: 0.2578 - accuracy: 0.9264
[2024-10-04T08:14:02.361+0000] {subprocess.py:93} INFO - model saved on : /home/***/gcs/data/models/mnist_linear_saved_model
[2024-10-04T08:14:02.694+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2024-10-04T08:14:02.712+0000] {taskinstance.py:1323} INFO - Marking task as SUCCESS. dag_id=***-mnist, task_id=train, execution_date=20241004T081350, start_date=20241004T081357, end_date=20241004T081402
[2024-10-04T08:14:02.745+0000] {local_task_job.py:208} INFO - Task exited with return code 0
[2024-10-04T08:14:02.761+0000] {taskinstance.py:2578} INFO - 1 downstream tasks scheduled from follow-on schedule check
